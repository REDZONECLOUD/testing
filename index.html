<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGame Store - Topup Game Terbaik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --dark: #1e1e24;
            --light: #f8f9fa;
            --success: #4cc9f0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/f1fed2c8-643d-4ba3-96ba-2f1bfba5f086.png') no-repeat center center fixed;
            background-size: cover;
            color: var(--light);
            min-height: 100vh;
        }

        .game-card {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .nav-link {
            position: relative;
        }

        .nav-link:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 0;
            background-color: var(--success);
            transition: width 0.3s ease;
        }

        .nav-link:hover:after {
            width: 100%;
        }

        .btn-primary {
            background: var(--primary);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: var(--secondary);
        }

        .btn-success {
            background: var(--success);
            transition: all 0.3s ease;
        }

        .btn-success:hover {
            background: #3aacd0;
        }

        .transaction-tablet {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            transform: translateY(150%);
            transition: transform 0.5s ease;
            z-index: 1000;
        }

        .transaction-tablet.active {
            transform: translateY(0);
        }

        #adminPanel {
            display: none;
        }

        /* Animation for login/register forms */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .auth-form {
            animation: fadeIn 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <nav class="bg-gray-900 bg-opacity-80 py-4 px-6 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center space-x-2">
            <img src="https://img1.pixhost.to/images/7034/619489613_malzhost.jpg" alt="GGame Store Logo" class="rounded-full w-20 h-20">
            <span class="text-xl font-bold text-white">GGame Store</span>
        </div>
        <div class="hidden md:flex space-x-6">
            <a href="#" class="nav-link text-white hover:text-green-300 transition">Beranda</a>
            <a href="#products" class="nav-link text-white hover:text-green-300 transition">Produk</a>
            <a href="#contact" class="nav-link text-white hover:text-green-300 transition">Kontak</a>
            <a href="#how-to-order" class="nav-link text-white hover:text-green-300 transition">Cara Order</a>
        </div>
        <div class="flex items-center space-x-4">
            <button id="loginBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">Login</button>
            <button id="registerBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">Register</button>
        </div>
    </nav>

    <section class="py-20 px-6 text-center">
        <h1 class="text-4xl md:text-6xl font-bold mb-6 text-white">Top Up Game Favoritmu</h1>
        <p class="text-xl md:text-2xl mb-10 text-gray-300">Free Fire, Mobile Legend, Honor of Kings dengan harga termurah!</p>
        <a href="#products" class="inline-block bg-green-500 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-green-600 transition">Lihat Produk</a>
    </section>

    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 rounded-xl p-8 w-full max-w-md auth-form">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Login</h2>
                <button id="closeLogin" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <form id="loginForm">
                <div class="mb-4">
                    <label for="loginEmail" class="block text-gray-300 mb-2">Email</label>
                    <input type="email" id="loginEmail" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-6">
                    <label for="loginPassword" class="block text-gray-300 mb-2">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">Login</button>
            </form>
        </div>
    </div>

    <div id="registerModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 rounded-xl p-8 w-full max-w-md auth-form">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Register</h2>
                <button id="closeRegister" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <form id="registerForm">
                <div class="mb-4">
                    <label for="regName" class="block text-gray-300 mb-2">Nama Lengkap</label>
                    <input type="text" id="regName" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="regEmail" class="block text-gray-300 mb-2">Email</label>
                    <input type="email" id="regEmail" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="regPhone" class="block text-gray-300 mb-2">Nomor HP (WhatsApp)</label>
                    <input type="tel" id="regPhone" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-6">
                    <label for="regPassword" class="block text-gray-300 mb-2">Password</label>
                    <input type="password" id="regPassword" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Daftar</button>
            </form>
        </div>
    </div>

    <div id="orderModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 rounded-xl p-8 w-full max-w-md auth-form">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white" id="orderModalTitle">Pesan Produk</h2>
                <button id="closeOrderModal" class="text-gray-400 hover:text-white">&times;</button>
            </div>
            <form id="orderForm">
                <input type="hidden" id="orderProductId">
                <div class="mb-4">
                    <label for="orderProductName" class="block text-gray-300 mb-2">Produk</label>
                    <input type="text" id="orderProductName" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white" readonly>
                </div>
                <div class="mb-4">
                    <label for="orderProductPrice" class="block text-gray-300 mb-2">Harga</label>
                    <input type="text" id="orderProductPrice" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white" readonly>
                </div>
                <div class="mb-4">
                    <label for="orderGameId" class="block text-gray-300 mb-2">ID Game / User ID</label>
                    <input type="text" id="orderGameId" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Masukkan ID Game Anda" required>
                </div>
                <div class="mb-6">
                    <label for="orderWhatsapp" class="block text-gray-300 mb-2">Nomor WhatsApp</label>
                    <input type="tel" id="orderWhatsapp" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nomor WhatsApp Anda" required>
                </div>
                <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Proses Pembayaran</button>
            </form>

            <div id="qrisPaymentSection" class="mt-8 text-center hidden">
                <h3 class="text-xl font-bold text-white mb-4">Scan QRIS untuk Pembayaran</h3>
                <img src="https://img1.pixhost.to/images/7029/619434153_malzhost.jpg" alt="QRIS Code" class="w-64 mx-auto rounded-lg mb-4">
                <p class="text-gray-300 mb-4">Total Pembayaran: <span id="qrisPaymentAmount" class="font-bold text-green-400"></span></p>
                <p class="text-gray-400 text-sm">Setelah pembayaran berhasil, klik tombol di bawah untuk konfirmasi dan diarahkan ke WhatsApp.</p>
                <button id="confirmPaymentBtn" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition mt-4">Konfirmasi Pembayaran & Lanjut ke WhatsApp</button>
            </div>
            
        </div>
    </div>

    <section id="products" class="py-16 px-6">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-3xl font-bold mb-12 text-center text-white">Produk Kami</h2>
            
            <div class="flex flex-wrap justify-center mb-10 gap-2">
                <button class="game-tab active px-6 py-2 rounded-lg bg-blue-600 text-white" data-game="all">Semua</button>
                <button class="game-tab px-6 py-2 rounded-lg bg-gray-700 text-white" data-game="freefire">Free Fire</button>
                <button class="game-tab px-6 py-2 rounded-lg bg-gray-700 text-white" data-game="ml">Mobile Legend</button>
                <button class="game-tab px-6 py-2 rounded-lg bg-gray-700 text-white" data-game="honor">Honor of Kings</button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="productsContainer">
                </div>
        </div>
    </section>

    <section id="adminPanel" class="py-16 px-6 bg-gray-900 bg-opacity-70">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-3xl font-bold mb-10 text-center text-white">Admin Dashboard</h2>
            
            <div class="bg-gray-800 rounded-xl p-6 mb-10">
                <h3 class="text-xl font-semibold mb-4 text-white">Tambah/Edit Produk</h3>
                <form id="productForm">
                    <input type="hidden" id="productId">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="gameSelect" class="block text-gray-300 mb-2">Game</label>
                            <select id="gameSelect" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="freefire">Free Fire</option>
                                <option value="ml">Mobile Legend</option>
                                <option value="honor">Honor of Kings</option>
                            </select>
                        </div>
                        <div>
                            <label for="productName" class="block text-gray-300 mb-2">Nama Produk</label>
                            <input type="text" id="productName" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="productPrice" class="block text-gray-300 mb-2">Harga</label>
                            <input type="number" id="productPrice" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="productStock" class="block text-gray-300 mb-2">Stok</label>
                            <input type="number" id="productStock" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="productImage" class="block text-gray-300 mb-2">Gambar URL</label>
                            <input type="text" id="productImage" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" value="https://placehold.co/400x225">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="productDesc" class="block text-gray-300 mb-2">Deskripsi</label>
                        <textarea id="productDesc" rows="3" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Simpan</button>
                        <button type="button" id="cancelEdit" class="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition">Batal</button>
                    </div>
                </form>
            </div>
            
            <div class="bg-gray-800 rounded-xl p-6">
                <h3 class="text-xl font-semibold mb-4 text-white">Daftar Produk</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-gray-700 rounded-lg overflow-hidden">
                        <thead>
                            <tr class="bg-gray-900 text-left">
                                <th class="px-6 py-3">Gambar</th>
                                <th class="px-6 py-3">Produk</th>
                                <th class="px-6 py-3">Game</th>
                                <th class="px-6 py-3">Harga</th>
                                <th class="px-6 py-3">Stok</th>
                                <th class="px-6 py-3">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="adminProductsList">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="py-16 px-6 bg-gray-900 bg-opacity-70">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-3xl font-bold mb-12 text-center text-white">Kontak Kami</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-gray-800 rounded-xl p-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">Informasi Kontak</h3>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-4">
                            <i class="fas fa-map-marker-alt text-green-400 mt-1"></i>
                            <div>
                                <h4 class="font-medium text-white">Alamat</h4>
                                <p class="text-gray-400">Jl. Digital No. 123, Jakarta, Indonesia</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-phone-alt text-green-400"></i>
                            <div>
                                <h4 class="font-medium text-white">Telepon</h4>
                                <p class="text-gray-400">+62 812 3456 7890</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fas fa-envelope text-green-400"></i>
                            <div>
                                <h4 class="font-medium text-white">Email</h4>
                                <p class="text-gray-400">support@ggamestore.com</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <i class="fab fa-whatsapp text-green-400"></i>
                            <div>
                                <h4 class="font-medium text-white">WhatsApp</h4>
                                <p class="text-gray-400">+62 812 3456 7890</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-800 rounded-xl p-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">Kirim Pesan</h3>
                    <form id="contactForm">
                        <div class="mb-4">
                            <input type="text" id="contactName" placeholder="Nama Lengkap" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div class="mb-4">
                            <input type="email" id="contactEmail" placeholder="Email" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div class="mb-4">
                            <input type="text" id="contactPhone" placeholder="Nomor WhatsApp" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div class="mb-4">
                            <textarea id="contactMessage" rows="4" placeholder="Pesan Anda" class="w-full px-4 py-2 bg-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
                        </div>
                        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">Kirim Pesan</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <section id="how-to-order" class="py-16 px-6">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-3xl font-bold mb-12 text-center text-white">Cara Order</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-gray-800 bg-opacity-80 rounded-xl p-6">
                    <div class="text-green-400 text-4xl mb-4 text-center">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-center text-white">1. Register / Login</h3>
                    <p class="text-gray-300 text-center">Buat akun atau login untuk mulai berbelanja</p>
                </div>
                
                <div class="bg-gray-800 bg-opacity-80 rounded-xl p-6">
                    <div class="text-green-400 text-4xl mb-4 text-center">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-center text-white">2. Pilih Produk</h3>
                    <p class="text-gray-300 text-center">Pilih produk yang ingin dibeli dan klik tombol "Pesan"</p>
                </div>
                
                <div class="bg-gray-800 bg-opacity-80 rounded-xl p-6">
                    <div class="text-green-400 text-4xl mb-4 text-center">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2 text-center text-white">3. Pembayaran & Konfirmasi</h3>
                    <p class="text-gray-300 text-center">Bayar via QRIS yang muncul atau konfirmasi pembayaran via WhatsApp</p>
                </div>
            </div>
            
            <div class="mt-12 text-center">
                <a href="#products" class="inline-block bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition">Mulai Belanja Sekarang</a>
            </div>
        </div>
    </section>

    <footer class="bg-gray-900 py-8 px-6">
        <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <div class="flex items-center space-x-2 mb-4">
                    <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/43e73fec-2a48-45a7-8dd0-5ebae83a6bd6.png" alt="GGame Store Logo" class="rounded-full">
                    <span class="text-lg font-bold text-white">GGame Store</span>
                </div>
                <p class="text-gray-400">Penyedia top up game termurah dan tercepat di Indonesia.</p>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold text-white mb-4">Tautan Cepat</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Beranda</a></li>
                    <li><a href="#products" class="text-gray-400 hover:text-white transition">Produk</a></li>
                    <li><a href="#contact" class="text-gray-400 hover:text-white transition">Kontak</a></li>
                    <li><a href="#how-to-order" class="text-gray-400 hover:text-white transition">Cara Order</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold text-white mb-4">Produk</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Free Fire</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Mobile Legend</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Honor of Kings</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="text-lg font-semibold text-white mb-4">Sosial Media</h4>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white text-xl"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white text-xl"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white text-xl"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-white text-xl"><i class="fab fa-whatsapp"></i></a>
                </div>
                <div class="mt-4">
                    <p class="text-gray-400">Berlangganan newsletter kami</p>
                    <div class="flex mt-2">
                        <input type="email" placeholder="Email Anda" class="px-4 py-2 bg-gray-700 text-white rounded-l-lg focus:outline-none w-full">
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-r-lg hover:bg-blue-700 transition"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="max-w-6xl mx-auto mt-8 pt-6 border-t border-gray-800 text-center text-gray-500">
            <p>© 2023 GGame Store. All rights reserved.</p>
        </div>
    </footer>

    <div class="transaction-tablet">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold text-white">Transaksi Terakhir</h3>
            <button id="closeTablet" class="text-gray-400 hover:text-white">&times;</button>
        </div>
        <div id="transactionDetails" class="text-gray-300">
            </div>
    </div>

    <script>
        // Database Simulation
        let users = JSON.parse(localStorage.getItem('users')) || [];
        // Add a default admin user if not present
        if (!users.some(u => u.email === 'admin@ggame.com')) {
            users.push({ name: 'Admin', email: 'admin@ggame.com', phone: '081234567899', password: 'adminpassword' });
            localStorage.setItem('users', JSON.stringify(users));
        }

        let products = [
            // Free Fire Products (15 items)
            { id: 1, game: 'freefire', name: 'Free Fire Diamonds 100', price: 20000, stock: 50, image: 'https://img1.pixhost.to/images/7040/619632671_malzhost.jpg', description: '100 Diamonds + bonus 5 diamonds' },
            { id: 2, game: 'freefire', name: 'Free Fire Diamonds 200', price: 35000, stock: 45, image: 'https://files.catbox.moe/v5f7nj.jpg', description: '200 Diamonds + bonus 15 diamonds' },
            { id: 3, game: 'freefire', name: 'Free Fire Diamonds 500', price: 80000, stock: 35, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1d845ffa-bc95-4f65-83a4-456731e87ae9.png', description: '500 Diamonds + bonus 50 diamonds' },
            { id: 4, game: 'freefire', name: 'Free Fire Diamonds 1000', price: 150000, stock: 25, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/dbc5d08f-568c-4036-b61f-3290329d4160.png', description: '1000 Diamonds + bonus 100 diamonds' },
            { id: 5, game: 'freefire', name: 'Free Fire Diamonds 2000', price: 280000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/20a39163-09c5-4d87-9c5c-4bba92281d70.png', description: '2000 Diamonds + bonus 200 diamonds' },
            { id: 6, game: 'freefire', name: 'Free Fire Diamonds 5000', price: 600000, stock: 10, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/bc4f98bd-dc20-41ff-88c0-3b2f4501e0ac.png', description: '5000 Diamonds + bonus 500 diamonds' },
            { id: 7, game: 'freefire', name: 'Elite Pass 30 Days', price: 120000, stock: 20, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/aed68543-c315-4003-8ae2-3e78ff897723.png', description: '30-day Elite Pass with exclusive rewards' },
            { id: 8, game: 'freefire', name: 'Character Bundle - Chrono', price: 75000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/9c637f15-7bb2-49be-9d50-38cc62685de6.png', description: 'Chrono character bundle' },
            { id: 9, game: 'freefire', name: 'Character Bundle - Jota', price: 75000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/aa7d671e-f1b0-4a93-81f5-e5ae5e1db233.png', description: 'Jota character bundle' },
            { id: 10, game: 'freefire', name: 'Character Bundle - Shirou', price: 75000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/7263a201-5378-430e-a008-30e158863c1f.png', description: 'Shirou character bundle' },
            { id: 11, game: 'freefire', name: 'Weapon Skin - AK47 Blood Moon', price: 50000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5667c2a6-475b-4cb1-8743-70a90a2b8cdb.png', description: 'AK47 Blood Moon skin' },
            { id: 12, game: 'freefire', name: 'Weapon Skin - M1887 Flame', price: 50000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/4d04f37f-be52-4d4a-bde8-5bde1dce6c5d.png', description: 'M1887 Flame skin' },
            { id: 13, game: 'freefire', name: 'Vehicle Skin - Dragon Bike', price: 40000, stock: 20, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/a24b1032-df7b-4f4c-876b-dc58a77da8ba.png', description: 'Dragon Bike skin' },
            { id: 14, game: 'freefire', name: 'Pet Skin - Robo', price: 30000, stock: 40, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5307f671-e0a9-4ff9-8f66-3110af44e3e0.png', description: 'Robo pet skin' },
            { id: 15, game: 'freefire', name: 'Premium Pack', price: 100000, stock: 25, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1d1d895b-c573-49a0-8d7f-3e639856f8ce.png', description: 'Premium items package' },
            
            // Mobile Legend Products (15 items)
            { id: 16, game: 'ml', name: 'MLBB Diamonds 100', price: 25000, stock: 50, image: 'https://files.catbox.moe/l1qpxq.jpg', description: '100 Diamonds + bonus 5' },
            { id: 17, game: 'ml', name: 'MLBB Diamonds 200', price: 40000, stock: 45, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/85326c69-7563-4482-baf9-027a8b1963bc.png', description: '200 Diamonds + bonus 15' },
            { id: 18, game: 'ml', name: 'MLBB Diamonds 500', price: 90000, stock: 35, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c7e104da-6aae-4a7d-82fc-c80f350f184f.png', description: '500 Diamonds + bonus 50' },
            { id: 19, game: 'ml', name: 'MLBB Diamonds 1000', price: 170000, stock: 25, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e1d0411d-8e8a-48de-88e5-5c7b9b3bb784.png', description: '1000 Diamonds + bonus 100' },
            { id: 20, game: 'ml', name: 'MLBB Diamonds 2000', price: 300000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/783bd426-989b-43c5-89e0-932319a5c91a.png', description: '2000 Diamonds + bonus 200' },
            { id: 21, game: 'ml', name: 'MLBB Diamonds 5000', price: 650000, stock: 10, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/d8eb093a-aea5-4520-85a3-b8cec54942bd.png', description: '5000 Diamonds + bonus 500' },
            { id: 22, game: 'ml', name: 'Starlight Member', price: 130000, stock: 20, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5840b8c1-5578-49b2-86b6-a82254307e50.png', description: 'Monthly Starlight benefits' },
            { id: 23, game: 'ml', name: 'Skin - Lesley Deadly Claw', price: 80000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/14979237-1b0e-459a-a84e-4f31bb9b4a0f.png', description: 'Lesley Deadly Claw skin' },
            { id: 24, game: 'ml', name: 'Skin - Gusion Starlight', price: 80000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/be18d617-0f5e-44db-a7f2-b1eeb4746000.png', description: 'Gusion Starlight skin' },
            { id: 25, game: 'ml', name: 'Skin - Layla Blazing Gun', price: 80000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/563e8ba8-0b82-47a7-a221-36920000c606.png', description: 'Layla Blazing Gun skin' },
            { id: 26, game: 'ml', name: 'Skin - Chou Dragon Boy', price: 50000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/fa2f567f-499c-4c2d-a63c-009a4b01667f.png', description: 'Chou Dragon Boy skin' },
            { id: 27, game: 'ml', name: 'Skin - Alucard Demon Prince', price: 50000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/0ff1769b-4603-4d3e-9397-628ce9adef61.png', description: 'Alucard Demon Prince skin' },
            { id: 28, game: 'ml', name: 'Skin - Moskov Dragon Hunter', price: 50000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/4a7e35a9-27dd-4a01-9de2-69319ae07754.png', description: 'Moskov Dragon Hunter skin' },
            { id: 29, game: 'ml', name: 'Recall Effect - Galaxy', price: 35000, stock: 40, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e4652d00-4cbf-4643-bd9a-cf5d19dbc208.png', description: 'Galaxy Recall Effect' },
            { id: 30, game: 'ml', name: 'Battle Emote - Dancing', price: 20000, stock: 50, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/4f066566-b55a-423f-a16c-0b68571216d6.png', description: 'Special dancing emote' },
            
            // Honor of Kings Products (5 items)
            { id: 31, game: 'honor', name: 'Honor of Kings Tokens 100', price: 22000, stock: 40, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c58479e0-336c-4824-874e-72cfd83505c8.png', description: '100 Tokens for in-game purchases' },
            { id: 32, game: 'honor', name: 'Honor of Kings Tokens 500', price: 100000, stock: 30, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/b851cf57-b003-49d6-95aa-2f95ce05c4ac.png', description: '500 Tokens + bonus' },
            { id: 33, game: 'honor', name: 'Honor of Kings Tokens 1000', price: 190000, stock: 20, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/93699316-2495-46aa-83a3-4b68e987c02b.png', description: '1000 Tokens + bonus' },
            { id: 34, game: 'honor', name: 'Hero Unlock Pack', price: 70000, stock: 15, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/092576b9-1144-411a-8530-81977b388c3a.png', description: 'Unlock a random hero' },
            { id: 35, game: 'honor', name: 'Skin Chest', price: 60000, stock: 25, image: 'https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/24a35010-3882-4148-af7b-1d70e6a84d2f.png', description: 'Get a random hero skin' },
        ];
        // Load products from localStorage or use default if empty
        if (localStorage.getItem('products')) {
            products = JSON.parse(localStorage.getItem('products'));
        } else {
            localStorage.setItem('products', JSON.stringify(products));
        }

        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let loggedInUser = JSON.parse(localStorage.getItem('loggedInUser')) || null;

        // --- Configuration ---
        const WHATSAPP_NUMBER = '6283816521302'; // Ganti dengan nomor WhatsApp Anda

        // DOM Elements
        const loginBtn = document.getElementById('loginBtn');
        const registerBtn = document.getElementById('registerBtn');
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const closeLogin = document.getElementById('closeLogin');
        const closeRegister = document.getElementById('closeRegister');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const productsContainer = document.getElementById('productsContainer');
        const gameTabs = document.querySelectorAll('.game-tab');
        const adminPanel = document.getElementById('adminPanel');
        const productForm = document.getElementById('productForm');
        const productIdInput = document.getElementById('productId');
        const gameSelect = document.getElementById('gameSelect');
        const productNameInput = document.getElementById('productName');
        const productPriceInput = document.getElementById('productPrice');
        const productStockInput = document.getElementById('productStock');
        const productImageInput = document.getElementById('productImage');
        const productDescInput = document.getElementById('productDesc');
        const cancelEditBtn = document.getElementById('cancelEdit');
        const adminProductsList = document.getElementById('adminProductsList');
        const transactionTablet = document.querySelector('.transaction-tablet');
        const closeTabletBtn = document.getElementById('closeTablet');
        const transactionDetails = document.getElementById('transactionDetails');

        // Order Modal Elements
        const orderModal = document.getElementById('orderModal');
        const closeOrderModal = document.getElementById('closeOrderModal');
        const orderForm = document.getElementById('orderForm');
        const orderProductId = document.getElementById('orderProductId');
        const orderProductName = document.getElementById('orderProductName');
        const orderProductPrice = document.getElementById('orderProductPrice');
        const orderGameId = document.getElementById('orderGameId');
        const orderWhatsapp = document.getElementById('orderWhatsapp');
        const qrisPaymentSection = document.getElementById('qrisPaymentSection');
        const qrisPaymentAmount = document.getElementById('qrisPaymentAmount');
        const confirmPaymentBtn = document.getElementById('confirmPaymentBtn');

        // --- Functions ---

        // Display Products
        function displayProducts(filter = 'all') {
            productsContainer.innerHTML = '';
            const filteredProducts = filter === 'all' ? products : products.filter(p => p.game === filter);

            filteredProducts.forEach(product => {
                const productCard = `
                    <div class="game-card bg-gray-800 rounded-xl shadow-lg">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-t-xl">
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-white mb-2">${product.name}</h3>
                            <p class="text-gray-300 mb-4">${product.description}</p>
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-2xl font-bold text-green-400">Rp${product.price.toLocaleString('id-ID')}</span>
                                <span class="text-gray-400 text-sm">Stok: ${product.stock}</span>
                            </div>
                            <button class="btn-success w-full py-3 rounded-lg font-semibold order-button" data-product-id="${product.id}" ${product.stock === 0 ? 'disabled' : ''}>
                                ${product.stock === 0 ? 'Stok Habis' : 'Pesan Sekarang'}
                            </button>
                        </div>
                    </div>
                `;
                productsContainer.innerHTML += productCard;
            });

            // Attach event listeners to new order buttons
            document.querySelectorAll('.order-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    const productId = parseInt(event.target.dataset.productId);
                    openOrderModal(productId);
                });
            });
        }

        // Open Order Modal
        function openOrderModal(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                alert('Produk tidak ditemukan!');
                return;
            }

            orderProductId.value = product.id;
            orderProductName.value = product.name;
            orderProductPrice.value = `Rp${product.price.toLocaleString('id-ID')}`;
            orderGameId.value = ''; // Clear previous input
            if (loggedInUser) {
                orderWhatsapp.value = loggedInUser.phone;
            } else {
                orderWhatsapp.value = ''; // Clear if not logged in
            }

            orderForm.classList.remove('hidden');
            qrisPaymentSection.classList.add('hidden');
            orderModal.classList.remove('hidden');
        }

        // Handle Order Form Submission
        orderForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const productId = parseInt(orderProductId.value);
            const gameId = orderGameId.value;
            const customerWhatsapp = orderWhatsapp.value; // Get customer's WhatsApp

            const product = products.find(p => p.id === productId);

            if (!product) {
                alert('Produk tidak ditemukan!');
                return;
            }
            if (product.stock <= 0) {
                alert('Stok produk habis!');
                return;
            }

            // Simulate creating a new transaction
            const newTransaction = {
                id: transactions.length + 1,
                userId: loggedInUser ? loggedInUser.email : 'guest',
                productId: product.id,
                productName: product.name,
                gameId: gameId,
                whatsapp: customerWhatsapp, // Store customer's WhatsApp
                amount: product.price,
                date: new Date().toLocaleString(),
                status: 'Menunggu Pembayaran'
            };
            transactions.push(newTransaction);
            localStorage.setItem('transactions', JSON.stringify(transactions));

            // Reduce stock
            product.stock--;
            localStorage.setItem('products', JSON.stringify(products)); // Update local storage for products
            displayProducts(document.querySelector('.game-tab.active').dataset.game); // Refresh product list

            // Display QRIS and payment details
            qrisPaymentAmount.textContent = `Rp${product.price.toLocaleString('id-ID')}`;
            orderForm.classList.add('hidden');
            qrisPaymentSection.classList.remove('hidden');
        });

        // Handle Confirm Payment Button
        confirmPaymentBtn.addEventListener('click', () => {
            const latestTransaction = transactions[transactions.length - 1];
            if (latestTransaction) {
                latestTransaction.status = 'Berhasil';
                localStorage.setItem('transactions', JSON.stringify(transactions));
                alert('Pembayaran berhasil dikonfirmasi! Anda akan diarahkan ke WhatsApp untuk konfirmasi pesanan.');
                
                displayLatestTransaction(latestTransaction); // Update transaction tablet
                orderModal.classList.add('hidden');
                qrisPaymentSection.classList.add('hidden'); // Hide QRIS section
                orderForm.classList.remove('hidden'); // Reset form display for next order

                // --- Redirect to WhatsApp with pre-filled message ---
                const message = `Halo GGame Store, saya sudah melakukan pembayaran untuk pesanan:\n\nProduk: ${latestTransaction.productName}\nID Game: ${latestTransaction.gameId}\nNomor WhatsApp Saya: ${latestTransaction.whatsapp}\nJumlah Pembayaran: Rp${latestTransaction.amount.toLocaleString('id-ID')}\nStatus: ${latestTransaction.status}\n\nMohon dibantu proses pesanan saya. Terima kasih.`;
                const whatsappURL = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(message)}`;
                window.open(whatsappURL, '_blank'); // Open in a new tab
            }
        });


        // Display latest transaction in tablet
        function displayLatestTransaction(transaction) {
            if (transaction) {
                transactionDetails.innerHTML = `
                    <p><strong>Produk:</strong> ${transaction.productName}</p>
                    <p><strong>ID Game:</strong> ${transaction.gameId}</p>
                    <p><strong>Total:</strong> Rp${transaction.amount.toLocaleString('id-ID')}</p>
                    <p><strong>Status:</strong> <span class="text-yellow-400">${transaction.status}</span></p>
                    <p><strong>Waktu:</strong> ${transaction.date}</p>
                    <p class="mt-2 text-sm text-gray-400">Terima kasih telah berbelanja di GGame Store!</p>
                `;
                transactionTablet.classList.add('active');
            } else {
                transactionDetails.innerHTML = '<p>Belum ada transaksi.</p>';
            }
        }

        // Admin Panel Product Listing
        function displayAdminProducts() {
            adminProductsList.innerHTML = '';
            products.forEach(product => {
                const row = `
                    <tr class="border-b border-gray-600 hover:bg-gray-600">
                        <td class="px-6 py-4"><img src="${product.image}" alt="${product.name}" class="w-16 h-auto rounded"></td>
                        <td class="px-6 py-4 text-white">${product.name}</td>
                        <td class="px-6 py-4 text-gray-300">${product.game.toUpperCase()}</td>
                        <td class="px-6 py-4 text-green-400">Rp${product.price.toLocaleString('id-ID')}</td>
                        <td class="px-6 py-4 text-gray-300">${product.stock}</td>
                        <td class="px-6 py-4">
                            <button class="bg-yellow-500 text-white px-3 py-1 rounded-md text-sm mr-2 edit-product-btn" data-id="${product.id}">Edit</button>
                            <button class="bg-red-600 text-white px-3 py-1 rounded-md text-sm delete-product-btn" data-id="${product.id}">Hapus</button>
                        </td>
                    </tr>
                `;
                adminProductsList.innerHTML += row;
            });

            document.querySelectorAll('.edit-product-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    editProduct(id);
                });
            });

            document.querySelectorAll('.delete-product-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const id = parseInt(e.target.dataset.id);
                    deleteProduct(id);
                });
            });
        }

        // Edit Product
        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                productIdInput.value = product.id;
                gameSelect.value = product.game;
                productNameInput.value = product.name;
                productPriceInput.value = product.price;
                productStockInput.value = product.stock;
                productImageInput.value = product.image;
                productDescInput.value = product.description;
            }
        }

        // Delete Product
        function deleteProduct(id) {
            if (confirm('Apakah Anda yakin ingin menghapus produk ini?')) {
                products = products.filter(p => p.id !== id);
                localStorage.setItem('products', JSON.stringify(products));
                displayAdminProducts();
                displayProducts(document.querySelector('.game-tab.active').dataset.game); // Refresh public product list
            }
        }

        // Toggle Admin Panel (only if logged in as admin)
        function toggleAdminPanel() {
            // Check if loggedInUser exists and their email matches the admin email
            if (loggedInUser && loggedInUser.email === 'admin@ggame.com') { 
                adminPanel.style.display = 'block';
                displayAdminProducts();
            } else {
                adminPanel.style.display = 'none';
            }
        }

        // Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            displayProducts();
            toggleAdminPanel(); // Check admin status on load
            if (transactions.length > 0) {
                displayLatestTransaction(transactions[transactions.length - 1]);
            }

            // Set login/register button text if logged in
            if (loggedInUser) {
                loginBtn.textContent = `Hai, ${loggedInUser.name.split(' ')[0]}`;
                registerBtn.textContent = 'Logout';
                registerBtn.classList.remove('bg-green-600');
                registerBtn.classList.add('bg-red-600');
            }
        });

        // --- Event Listeners ---

        // Login Button
        loginBtn.addEventListener('click', () => {
            if (loggedInUser) {
                alert(`Anda sudah login sebagai ${loggedInUser.name}`);
                return;
            }
            loginModal.classList.remove('hidden');
        });

        // Register Button / Logout Button
        registerBtn.addEventListener('click', () => {
            if (loggedInUser) {
                // Perform logout
                loggedInUser = null;
                localStorage.removeItem('loggedInUser');
                alert('Anda telah logout.');
                loginBtn.textContent = 'Login';
                registerBtn.textContent = 'Register';
                registerBtn.classList.remove('bg-red-600');
                registerBtn.classList.add('bg-green-600');
                toggleAdminPanel(); // Hide admin panel on logout
                transactionTablet.classList.remove('active'); // Hide transaction tablet on logout
            } else {
                registerModal.classList.remove('hidden');
            }
        });

        // Close Modals
        closeLogin.addEventListener('click', () => loginModal.classList.add('hidden'));
        closeRegister.addEventListener('click', () => registerModal.classList.add('hidden'));
        closeOrderModal.addEventListener('click', () => {
            orderModal.classList.add('hidden');
            orderForm.classList.remove('hidden'); // Reset form display
            qrisPaymentSection.classList.add('hidden'); // Hide QRIS section
        });
        closeTabletBtn.addEventListener('click', () => transactionTablet.classList.remove('active'));


        // Login Form Submission
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                loggedInUser = user;
                localStorage.setItem('loggedInUser', JSON.stringify(loggedInUser));
                alert(`Selamat datang kembali, ${loggedInUser.name}!`);
                loginModal.classList.add('hidden');
                loginBtn.textContent = `Hai, ${loggedInUser.name.split(' ')[0]}`;
                registerBtn.textContent = 'Logout';
                registerBtn.classList.remove('bg-green-600');
                registerBtn.classList.add('bg-red-600');
                toggleAdminPanel(); // Show/hide admin panel based on login status
            } else {
                alert('Email atau password salah.');
            }
        });

        // Register Form Submission
        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const phone = document.getElementById('regPhone').value;
            const password = document.getElementById('regPassword').value;

            if (users.some(u => u.email === email)) {
                alert('Email sudah terdaftar. Silakan login atau gunakan email lain.');
                return;
            }

            const newUser = { name, email, phone, password };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            alert('Registrasi berhasil! Silakan login.');
            registerModal.classList.add('hidden');
            document.getElementById('loginEmail').value = email;
            document.getElementById('loginPassword').value = password;
            loginModal.classList.remove('hidden'); // Auto-open login modal after registration
        });

        // Game Tabs
        gameTabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                gameTabs.forEach(t => {
                    t.classList.remove('active', 'bg-blue-600');
                    t.classList.add('bg-gray-700');
                });
                e.target.classList.add('active', 'bg-blue-600');
                e.target.classList.remove('bg-gray-700');
                displayProducts(e.target.dataset.game);
            });
        });

        // Admin Product Form Submission
        productForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const id = productIdInput.value ? parseInt(productIdInput.value) : null;
            const game = gameSelect.value;
            const name = productNameInput.value;
            const price = parseInt(productPriceInput.value);
            const stock = parseInt(productStockInput.value);
            const image = productImageInput.value;
            const description = productDescInput.value;

            if (id) {
                // Edit existing product
                const productIndex = products.findIndex(p => p.id === id);
                if (productIndex !== -1) {
                    products[productIndex] = { ...products[productIndex], game, name, price, stock, image, description };
                    alert('Produk berhasil diupdate!');
                }
            } else {
                // Add new product
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                const newProduct = { id: newId, game, name, price, stock, image, description };
                products.push(newProduct);
                alert('Produk berhasil ditambahkan!');
            }

            localStorage.setItem('products', JSON.stringify(products));
            productForm.reset();
            productIdInput.value = ''; // Clear ID after saving
            displayAdminProducts();
            displayProducts(document.querySelector('.game-tab.active').dataset.game); // Refresh public product list
        });

        // Cancel Edit
        cancelEditBtn.addEventListener('click', () => {
            productForm.reset();
            productIdInput.value = '';
        });

        // Save products and users to localStorage on page unload (optional, for persistence)
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('products', JSON.stringify(products));
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('transactions', JSON.stringify(transactions));
        });
    </script>
</body>
</html>